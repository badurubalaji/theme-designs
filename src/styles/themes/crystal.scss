// ============================================================================
// CRYSTAL DESIGN THEME - Gem-like Transparency Prebuilt Template
// ============================================================================
// Usage: Import this file directly in your angular.json or styles.scss
// @import 'themes/crystal';
// or link the compiled CSS in your index.html
// ============================================================================

@use '@angular/material' as mat;
@use 'palettes' as palettes;

// =============================================================================
// Crystal Design Custom Variables
// =============================================================================

:root {
    // Theme identification
    --theme-name: 'crystal';
    --theme-style: 'gem-transparency';

    // Refraction effect configurations
    --crystal-refraction-angle: 135deg;
    --crystal-refraction-start: rgba(255, 255, 255, 0.4);
    --crystal-refraction-end: transparent;

    // Surface transparency levels
    --crystal-transparency-primary: 0.92;
    --crystal-transparency-secondary: 0.85;
    --crystal-transparency-tertiary: 0.75;

    // Edge highlights (light reflection)
    --crystal-edge-light: rgba(255, 255, 255, 0.6);
    --crystal-edge-shadow: rgba(0, 0, 0, 0.08);

    // Prismatic highlight colors
    --crystal-prism-warm: rgba(255, 220, 255, 0.15);
    --crystal-prism-cool: rgba(220, 255, 255, 0.15);
    --crystal-prism-gold: rgba(255, 245, 200, 0.12);

    // Sharp edges for crystal aesthetic
    --mat-shape-corner-xs: 2px;
    --mat-shape-corner-sm: 4px;
    --mat-shape-corner-md: 6px;
    --mat-shape-corner-lg: 8px;
    --mat-shape-corner-xl: 12px;
    --mat-shape-corner-full: 9999px;
}

// =============================================================================
// Theme Configuration
// =============================================================================

html {
    @include mat.theme((color: (theme-type: light,
                primary: palettes.$indigo-palette,
                tertiary: palettes.$rose-palette,
            ),
            typography: Roboto,
            density: 0,
        ));

    // Slightly transparent surfaces
    --mat-sys-surface: rgba(255, 255, 255, var(--crystal-transparency-primary));
    --mat-sys-surface-container: rgba(250, 250, 255, var(--crystal-transparency-secondary));
    --mat-sys-surface-container-low: rgba(245, 245, 255, var(--crystal-transparency-tertiary));
    --mat-sys-surface-container-high: rgba(255, 255, 255, var(--crystal-transparency-primary));
    --mat-sys-surface-variant: rgba(248, 248, 255, var(--crystal-transparency-secondary));
}

// Dark theme variant
html.dark-theme,
html[data-theme="dark"] {
    @include mat.theme((color: (theme-type: dark,
                primary: palettes.$indigo-palette,
                tertiary: palettes.$rose-palette,
            ),
            typography: Roboto,
            density: 0,
        ));

    --crystal-edge-light: rgba(255, 255, 255, 0.2);
    --crystal-edge-shadow: rgba(0, 0, 0, 0.3);
    --crystal-prism-warm: rgba(255, 200, 255, 0.08);
    --crystal-prism-cool: rgba(200, 255, 255, 0.08);

    --mat-sys-surface: rgba(28, 28, 35, var(--crystal-transparency-primary));
    --mat-sys-surface-container: rgba(35, 35, 45, var(--crystal-transparency-secondary));
}

// =============================================================================
// Base Styles
// =============================================================================

body {
    // Subtle gradient background to show crystal transparency
    background: linear-gradient(180deg,
            #f8f9ff 0%,
            #eef1f8 50%,
            #e8ecf5 100%);
    background-attachment: fixed;
    color: var(--mat-sys-on-surface);
    font-family: var(--mat-sys-body-medium-font);
    margin: 0;
    min-height: 100vh;
}

.dark-theme body,
[data-theme="dark"] body {
    background: linear-gradient(180deg,
            #1a1a25 0%,
            #15152a 50%,
            #101025 100%);
}

// =============================================================================
// Crystal Effect Base Class
// =============================================================================

.crystal,
.mat-mdc-card {
    position: relative;
    background: linear-gradient(var(--crystal-refraction-angle),
            var(--crystal-refraction-start) 0%,
            var(--crystal-refraction-end) 50%), rgba(255, 255, 255, var(--crystal-transparency-secondary)) !important;
    border-radius: var(--mat-shape-corner-lg);
    border: 1px solid var(--crystal-edge-light);
    box-shadow:
        0 4px 24px var(--crystal-edge-shadow),
        inset 0 1px 0 var(--crystal-edge-light),
        inset 0 -1px 0 var(--crystal-edge-shadow);
    overflow: hidden;
    transition: all 0.3s ease-in-out;

    // Prismatic overlay
    &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg,
                var(--crystal-prism-warm) 0%,
                transparent 35%,
                transparent 65%,
                var(--crystal-prism-cool) 100%);
        pointer-events: none;
        border-radius: inherit;
        opacity: 0.7;
        transition: opacity 0.3s ease;
    }

    &:hover {
        box-shadow:
            0 8px 40px var(--crystal-edge-shadow),
            inset 0 1px 0 var(--crystal-edge-light),
            inset 0 -1px 0 var(--crystal-edge-shadow);

        &::before {
            opacity: 1;
        }
    }
}

// =============================================================================
// Crystal Component Overrides
// =============================================================================

// Buttons with crystal facet effect
.mat-mdc-button,
.mat-mdc-raised-button,
.mat-mdc-flat-button {
    position: relative;
    background: linear-gradient(180deg,
            rgba(255, 255, 255, 0.9) 0%,
            rgba(255, 255, 255, 0.7) 100%) !important;
    border: 1px solid var(--crystal-edge-light);
    border-radius: var(--mat-shape-corner-sm);
    box-shadow:
        0 2px 8px var(--crystal-edge-shadow),
        inset 0 1px 0 var(--crystal-edge-light);
    transition: all 0.2s ease-in-out;
    overflow: hidden;

    &::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.4) 50%,
                transparent 100%);
        transition: left 0.5s ease;
    }

    &:hover {
        box-shadow:
            0 4px 16px var(--crystal-edge-shadow),
            inset 0 1px 0 var(--crystal-edge-light);

        &::before {
            left: 100%;
        }
    }
}

// Outlined buttons - more transparent
.mat-mdc-outlined-button {
    background: rgba(255, 255, 255, 0.5) !important;
    border: 1px solid var(--crystal-edge-light) !important;
    box-shadow: inset 0 1px 0 var(--crystal-edge-light);
}

// FAB with crystal styling
.mat-mdc-fab,
.mat-mdc-mini-fab {
    position: relative;
    border: 1px solid var(--crystal-edge-light);
    box-shadow:
        0 4px 20px var(--crystal-edge-shadow),
        inset 0 2px 0 var(--crystal-edge-light);
    overflow: hidden;

    &::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 50%;
        background: linear-gradient(180deg,
                rgba(255, 255, 255, 0.2) 0%,
                transparent 100%);
        pointer-events: none;
        border-radius: inherit;
    }
}

// Form fields
.mat-mdc-form-field {
    .mdc-text-field {
        background: linear-gradient(180deg,
                rgba(255, 255, 255, 0.8) 0%,
                rgba(255, 255, 255, 0.6) 100%) !important;
        border: 1px solid var(--crystal-edge-light);
        border-radius: var(--mat-shape-corner-sm) !important;
        box-shadow: inset 0 1px 0 var(--crystal-edge-light);
    }

    // Keep label visible, just hide border
    .mdc-notched-outline,
    .mdc-notched-outline__leading,
    .mdc-notched-outline__notch,
    .mdc-notched-outline__trailing {
        border-color: transparent !important;
    }

    .mat-mdc-floating-label {
        color: var(--mat-sys-on-surface) !important;
    }

    &.mat-focused .mat-mdc-floating-label {
        color: var(--mat-sys-primary) !important;
    }
}

// Chips with gem effect
.mat-mdc-chip {
    position: relative;
    background: linear-gradient(135deg,
            rgba(255, 255, 255, 0.9) 0%,
            rgba(255, 255, 255, 0.7) 100%) !important;
    border: 1px solid var(--crystal-edge-light);
    border-radius: var(--mat-shape-corner-sm);
    box-shadow:
        0 2px 8px var(--crystal-edge-shadow),
        inset 0 1px 0 var(--crystal-edge-light);
    overflow: hidden;

    &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 50%;
        background: linear-gradient(180deg,
                rgba(255, 255, 255, 0.3) 0%,
                transparent 100%);
        pointer-events: none;
    }
}

// Dialog with crystal frame
.mat-mdc-dialog-container {
    position: relative;
    background: linear-gradient(var(--crystal-refraction-angle),
            rgba(255, 255, 255, 0.98) 0%,
            rgba(255, 255, 255, 0.95) 100%) !important;
    border: 1px solid var(--crystal-edge-light);
    border-radius: var(--mat-shape-corner-xl) !important;
    box-shadow:
        0 24px 80px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 var(--crystal-edge-light);
    overflow: hidden;

    &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg,
                var(--crystal-prism-warm) 0%,
                transparent 30%,
                transparent 70%,
                var(--crystal-prism-cool) 100%);
        pointer-events: none;
    }
}

// Menu
.mat-mdc-menu-panel {
    background: linear-gradient(180deg,
            rgba(255, 255, 255, 0.98) 0%,
            rgba(255, 255, 255, 0.95) 100%) !important;
    border: 1px solid var(--crystal-edge-light);
    border-radius: var(--mat-shape-corner-md);
    box-shadow:
        0 8px 32px var(--crystal-edge-shadow),
        inset 0 1px 0 var(--crystal-edge-light);
}

// Tabs with crystal bar
.mat-mdc-tab-header {
    background: linear-gradient(180deg,
            rgba(255, 255, 255, 0.7) 0%,
            rgba(255, 255, 255, 0.5) 100%);
    border: 1px solid var(--crystal-edge-light);
    border-radius: var(--mat-shape-corner-sm);
}

// Expansion panels
.mat-expansion-panel {
    background: linear-gradient(var(--crystal-refraction-angle),
            rgba(255, 255, 255, 0.9) 0%,
            rgba(255, 255, 255, 0.8) 100%) !important;
    border: 1px solid var(--crystal-edge-light);
    box-shadow:
        0 2px 12px var(--crystal-edge-shadow),
        inset 0 1px 0 var(--crystal-edge-light);
}

// Autocomplete
.mat-mdc-autocomplete-panel {
    background: linear-gradient(180deg,
            rgba(255, 255, 255, 0.98) 0%,
            rgba(255, 255, 255, 0.95) 100%) !important;
    border: 1px solid var(--crystal-edge-light);
    border-radius: var(--mat-shape-corner-md);
    box-shadow:
        0 8px 32px var(--crystal-edge-shadow),
        inset 0 1px 0 var(--crystal-edge-light);

    .mat-mdc-option {
        &:hover {
            background: linear-gradient(180deg,
                    rgba(255, 255, 255, 0.7) 0%,
                    rgba(255, 255, 255, 0.5) 100%);
        }

        &.mdc-list-item--selected {
            background: linear-gradient(135deg,
                    var(--crystal-prism-warm) 0%,
                    transparent 50%,
                    var(--crystal-prism-cool) 100%);
        }

        &.mat-mdc-option-active {
            background: rgba(var(--mat-sys-primary), 0.08);
        }
    }

    .mat-mdc-optgroup-label {
        color: var(--mat-sys-on-surface-variant);
        font-weight: 500;
    }
}

// Snackbar
.mat-mdc-snack-bar-container {
    background: linear-gradient(180deg,
            rgba(50, 50, 60, 0.95) 0%,
            rgba(40, 40, 50, 0.98) 100%) !important;
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--mat-shape-corner-sm);
}

// Tooltip
.mat-mdc-tooltip .mdc-tooltip__surface {
    background: rgba(50, 50, 60, 0.9);
    border-radius: var(--mat-shape-corner-xs);
}

// Sidenav
.mat-sidenav {
    background: linear-gradient(180deg,
            rgba(255, 255, 255, 0.98) 0%,
            rgba(250, 250, 255, 0.95) 100%);
    border-right: 1px solid var(--crystal-edge-light);
}

// Toolbar
.mat-toolbar {
    background: linear-gradient(180deg,
            rgba(255, 255, 255, 0.95) 0%,
            rgba(255, 255, 255, 0.9) 100%);
    border-bottom: 1px solid var(--crystal-edge-light);
}

// Table
.mat-mdc-table {
    background: rgba(255, 255, 255, var(--crystal-transparency-secondary));
    border-radius: var(--mat-shape-corner-md);
    border: 1px solid var(--crystal-edge-light);
}

// Paginator
.mat-mdc-paginator {
    background: rgba(255, 255, 255, var(--crystal-transparency-secondary));
    border-radius: var(--mat-shape-corner-sm);
}

// Progress Bar
.mat-mdc-progress-bar {
    border-radius: var(--mat-shape-corner-full);
}

// =============================================================================
// Utility Classes
// =============================================================================

.crystal-facet {
    position: relative;
    overflow: hidden;

    &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 50%;
        background: linear-gradient(180deg,
                rgba(255, 255, 255, 0.3) 0%,
                transparent 100%);
        pointer-events: none;
    }
}

.crystal-shimmer {
    position: relative;
    overflow: hidden;

    &::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 50%;
        height: 100%;
        background: linear-gradient(90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.5) 50%,
                transparent 100%);
        animation: crystal-shimmer 3s ease-in-out infinite;
    }
}

@keyframes crystal-shimmer {
    0% {
        left: -100%;
    }

    50% {
        left: 100%;
    }

    100% {
        left: 100%;
    }
}

.crystal-prism {
    background: linear-gradient(135deg,
            var(--crystal-prism-warm) 0%,
            transparent 25%,
            var(--crystal-prism-gold) 50%,
            transparent 75%,
            var(--crystal-prism-cool) 100%);
}

// Surface utilities
.surface {
    background: rgba(255, 255, 255, var(--crystal-transparency-secondary));
}

.text-primary {
    color: var(--mat-sys-primary);
}

.text-secondary {
    color: var(--mat-sys-secondary);
}

.rounded-xs {
    border-radius: var(--mat-shape-corner-xs);
}

.rounded-sm {
    border-radius: var(--mat-shape-corner-sm);
}

.rounded-md {
    border-radius: var(--mat-shape-corner-md);
}

.rounded-lg {
    border-radius: var(--mat-shape-corner-lg);
}

.rounded-xl {
    border-radius: var(--mat-shape-corner-xl);
}

.rounded-full {
    border-radius: var(--mat-shape-corner-full);
}